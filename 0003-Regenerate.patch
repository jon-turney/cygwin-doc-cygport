From f3753f72fcba116e488aa2b25c761d469c751973 Mon Sep 17 00:00:00 2001
From: Jon TURNEY <jon.turney@dronecode.org.uk>
Date: Tue, 23 Jun 2015 15:25:17 +0100
Subject: [PATCH 3/6] Regenerate

---
 newlib/libc/Makefile.in         | 28 +++++++++----
 newlib/libc/ctype/Makefile.in   | 23 +++++++---
 newlib/libc/locale/Makefile.in  | 23 +++++++---
 newlib/libc/misc/Makefile.in    | 23 +++++++---
 newlib/libc/posix/Makefile.in   | 23 +++++++---
 newlib/libc/search/Makefile.in  | 20 ++++++---
 newlib/libc/signal/Makefile.in  | 25 ++++++++---
 newlib/libc/stdio/Makefile.in   | 25 ++++++++---
 newlib/libc/stdio64/Makefile.in | 25 ++++++++---
 newlib/libc/stdlib/Makefile.in  | 25 ++++++++---
 newlib/libc/string/Makefile.in  | 22 +++++++---
 newlib/libc/time/Makefile.in    | 25 ++++++++---
 newlib/libm/Makefile.in         | 28 +++++++++----
 newlib/libm/common/Makefile.in  | 18 ++++++--
 newlib/libm/complex/Makefile.in | 93 ++++++++++++++++++++++++++++-------------
 newlib/libm/math/Makefile.in    | 40 +++++++++++-------
 16 files changed, 345 insertions(+), 121 deletions(-)

diff --git a/newlib/libc/Makefile.in b/newlib/libc/Makefile.in
index cbddc5f..4da4453 100644
--- a/newlib/libc/Makefile.in
+++ b/newlib/libc/Makefile.in
@@ -435,7 +435,7 @@ CLEANFILES = $(CRT0) \
 	sigset.texi stmp-sigset extra.texi stmp-extra \
 	stdio64.texi stmp-stdio64 targetdep.tex stmp-targetdep \
 	tmp-sigset.texi tmp-iconvset.texi tmp-extra.texi \
-	tmp-stdio64.texi tmp-posix.texi tmp-targetdep.texi
+	tmp-stdio64.texi tmp-posix.texi tmp-targetdep.texi *.3 *.xml
 
 ACLOCAL_AMFLAGS = -I .. -I ../..
 CONFIG_STATUS_DEPENDENCIES = $(newlib_basedir)/configure.host
@@ -858,7 +858,7 @@ info: info-recursive
 
 info-am: $(INFO_DEPS)
 
-install-data-am:
+install-data-am: install-data-local
 
 install-dvi: install-dvi-recursive
 
@@ -1010,11 +1010,11 @@ uninstall-am: uninstall-dvi-am uninstall-html-am uninstall-info-am \
 	distclean distclean-compile distclean-generic \
 	distclean-libtool distclean-tags dvi dvi-am html html-am info \
 	info-am install install-am install-data install-data-am \
-	install-dvi install-dvi-am install-exec install-exec-am \
-	install-html install-html-am install-info install-info-am \
-	install-man install-pdf install-pdf-am install-ps \
-	install-ps-am install-strip installcheck installcheck-am \
-	installdirs installdirs-am maintainer-clean \
+	install-data-local install-dvi install-dvi-am install-exec \
+	install-exec-am install-html install-html-am install-info \
+	install-info-am install-man install-pdf install-pdf-am \
+	install-ps install-ps-am install-strip installcheck \
+	installcheck-am installdirs installdirs-am maintainer-clean \
 	maintainer-clean-aminfo maintainer-clean-generic mostlyclean \
 	mostlyclean-aminfo mostlyclean-compile mostlyclean-generic \
 	mostlyclean-libtool pdf pdf-am ps ps-am tags tags-recursive \
@@ -1118,6 +1118,20 @@ targetdep.tex: stmp-targetdep ; @true
 
 $(SUBDEFS): stmp-targetdep ; @true
 
+docbook: $(SUBDEFS) libc.in.xml
+	xsltproc --xinclude --path ${builddir} --nonet ${srcdir}/../refcontainers.xslt ${srcdir}/libc.in.xml >libc.xml
+	-xmllint --xinclude --path ${builddir} --postvalid --noent --nonet --noout libc.xml
+	xmlto --skip-validation --searchpath ${builddir} html-nochunks --stringparam funcsynopsis.style=ansi libc.xml
+	xmlto --skip-validation --searchpath ${builddir} man -m ${srcdir}/../man.xsl libc.xml
+
+doc: docbook
+
+install-data-local:
+	mkdir -p $(DESTDIR)$(htmldir)
+	$(INSTALL_DATA) libc.html $(DESTDIR)$(htmldir)/
+	mkdir -p $(DESTDIR)$(mandir)/man3
+	$(INSTALL_DATA) *.3 $(DESTDIR)$(mandir)/man3
+
 .PHONY: force
 force:
 
diff --git a/newlib/libc/ctype/Makefile.in b/newlib/libc/ctype/Makefile.in
index 3272b99..e48cbd8 100644
--- a/newlib/libc/ctype/Makefile.in
+++ b/newlib/libc/ctype/Makefile.in
@@ -374,14 +374,18 @@ CHEWOUT_FILES = \
 	wctrans.def	\
 	wctype.def	
 
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = ctype.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -843,11 +847,20 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
+doc-texinfo: $(CHEWOUT_FILES)
 	cat $(srcdir)/ctype.tex >> $(TARGETDOC)
 
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/$(CHAPTER) >../$(DOCBOOK_CHAPTER)
+
+doc: doc-docbook doc-texinfo
+
 $(lpfx)ctype_.$(oext): ctype_.c ctype_iso.h ctype_cp.h
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
diff --git a/newlib/libc/locale/Makefile.in b/newlib/libc/locale/Makefile.in
index b3fa348..5e2cb9a 100644
--- a/newlib/libc/locale/Makefile.in
+++ b/newlib/libc/locale/Makefile.in
@@ -287,12 +287,16 @@ liblocale_la_LDFLAGS = -Xcompiler -nostdlib
 CHEWOUT_FILES = locale.def
 SUFFIXES = .def
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = locale.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .c .lo .o .obj .xml
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -598,10 +602,19 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
-	cat $(srcdir)/locale.tex >> $(TARGETDOC)
+doc-texinfo: $(CHEWOUT_FILES)
+	cat $(srcdir)/${CHAPTER} >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
+
+doc: doc-docbook doc-texinfo
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
diff --git a/newlib/libc/misc/Makefile.in b/newlib/libc/misc/Makefile.in
index 3dde584..a6ad712 100644
--- a/newlib/libc/misc/Makefile.in
+++ b/newlib/libc/misc/Makefile.in
@@ -264,12 +264,16 @@ libmisc_la_LDFLAGS = -Xcompiler -nostdlib
 CHEWOUT_FILES = unctrl.def ffs.def
 SUFFIXES = .def
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = misc.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .c .lo .o .obj .xml
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -551,10 +555,19 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
-	cat $(srcdir)/misc.tex >> $(TARGETDOC)
+doc-texinfo: $(CHEWOUT_FILES)
+	cat $(srcdir)/${CHAPTER} >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
+
+doc: doc-docbook doc-texinfo
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
diff --git a/newlib/libc/posix/Makefile.in b/newlib/libc/posix/Makefile.in
index 2982dcd..ce1cc88 100644
--- a/newlib/libc/posix/Makefile.in
+++ b/newlib/libc/posix/Makefile.in
@@ -325,13 +325,17 @@ CHEWOUT_FILES = \
 
 SUFFIXES = .def
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = posix.tex
 TARGETDOC = ../tmp.texi
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
 AM_CFLAGS = -D_GNU_SOURCE
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .c .lo .o .obj .xml
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -769,10 +773,19 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
-	cat $(srcdir)/posix.tex >> $(TARGETDOC)
+doc-texinfo: $(CHEWOUT_FILES)
+	cat $(srcdir)/${CHAPTER} >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
+
+doc: doc-docbook doc-texinfo
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
diff --git a/newlib/libc/search/Makefile.in b/newlib/libc/search/Makefile.in
index 755ec8a..d965831 100644
--- a/newlib/libc/search/Makefile.in
+++ b/newlib/libc/search/Makefile.in
@@ -313,7 +313,7 @@ libsearch_la_LDFLAGS = -Xcompiler -nostdlib
 @USE_LIBTOOL_FALSE@noinst_LIBRARIES = lib.a
 @USE_LIBTOOL_FALSE@lib_a_SOURCES = $(GENERAL_SOURCES) $(ELIX_2_SOURCES) $(ELIX_4_SOURCES)
 @USE_LIBTOOL_FALSE@lib_a_CFLAGS = $(AM_CFLAGS)
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEWOUT_FILES = \
 	bsearch.def \
 	qsort.def \
@@ -321,11 +321,13 @@ CHEWOUT_FILES = \
 
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -673,9 +675,17 @@ uninstall-am:
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
+doc-texinfo: $(CHEWOUT_FILES)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+
+doc: doc-docbook doc-texinfo
 objectlist.awk.in: $(noinst_LTLIBRARIES)
 	-rm -f objectlist.awk.in
 	for i in `ls *.lo` ; \
diff --git a/newlib/libc/signal/Makefile.in b/newlib/libc/signal/Makefile.in
index 92a06f7..01e65c7 100644
--- a/newlib/libc/signal/Makefile.in
+++ b/newlib/libc/signal/Makefile.in
@@ -262,14 +262,18 @@ libsignal_la_LDFLAGS = -Xcompiler -nostdlib
 @USE_LIBTOOL_FALSE@lib_a_SOURCES = $(LIB_SOURCES)
 @USE_LIBTOOL_FALSE@lib_a_CFLAGS = $(AM_CFLAGS)
 CHEWOUT_FILES = psignal.def raise.def signal.def
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = signal.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -539,10 +543,19 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
-	cat $(srcdir)/signal.tex >> $(TARGETDOC)
+doc-texinfo: $(CHEWOUT_FILES)
+	cat $(srcdir)/$(CHAPTER) >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
+
+doc: doc-docbook doc-texinfo
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
diff --git a/newlib/libc/stdio/Makefile.in b/newlib/libc/stdio/Makefile.in
index 1d7deab..f2fca97 100644
--- a/newlib/libc/stdio/Makefile.in
+++ b/newlib/libc/stdio/Makefile.in
@@ -735,14 +735,18 @@ CHEWOUT_FILES = \
 	vfwprintf.def		\
 	vfwscanf.def
 
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = stdio.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -1930,10 +1934,19 @@ $(lpfx)svfiwscanf.$(oext): vfwscanf.c
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
-	cat $(srcdir)/stdio.tex >> $(TARGETDOC)
+doc-texinfo: $(CHEWOUT_FILES)
+	cat $(srcdir)/$(CHAPTER) >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
+
+doc: doc-docbook doc-texinfo
 
 $(lpfx)clearerr.$(oext): local.h
 $(lpfx)clearerr_u.$(oext): local.h
diff --git a/newlib/libc/stdio64/Makefile.in b/newlib/libc/stdio64/Makefile.in
index d445f53..93e66ca 100644
--- a/newlib/libc/stdio64/Makefile.in
+++ b/newlib/libc/stdio64/Makefile.in
@@ -302,14 +302,18 @@ CHEWOUT_FILES = \
 	ftello64.def		\
 	tmpfile64.def
 
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = stdio64.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -621,10 +625,19 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
-	cat $(srcdir)/stdio64.tex >> $(TARGETDOC)
+doc-texinfo: $(CHEWOUT_FILES)
+	cat $(srcdir)/$(CHAPTER) >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
+
+doc: doc-docbook doc-texinfo
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
diff --git a/newlib/libc/stdlib/Makefile.in b/newlib/libc/stdlib/Makefile.in
index 34da1cb..b12dc17 100644
--- a/newlib/libc/stdlib/Makefile.in
+++ b/newlib/libc/stdlib/Makefile.in
@@ -526,14 +526,18 @@ CHEWOUT_FILES = \
 	wcstombs.def	\
 	wctomb.def	
 
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = stdlib.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -1463,10 +1467,19 @@ $(lpfx)$(MALLOPTR).$(oext): $(MALLOCR).c
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
-	cat $(srcdir)/stdlib.tex >> $(TARGETDOC)
+doc-texinfo: $(CHEWOUT_FILES)
+	cat $(srcdir)/$(CHAPTER) >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
+
+doc: doc-docbook doc-texinfo
 
 $(lpfx)dtoa.$(oext): dtoa.c mprec.h
 $(lpfx)ldtoa.$(oext): ldtoa.c mprec.h
diff --git a/newlib/libc/string/Makefile.in b/newlib/libc/string/Makefile.in
index 5bf406e..8e7847c 100644
--- a/newlib/libc/string/Makefile.in
+++ b/newlib/libc/string/Makefile.in
@@ -448,14 +448,16 @@ wcswidth.def	wcsxfrm.def	wcwidth.def	wmemchr.def \
 wmemcmp.def	wmemcpy.def	wmemmove.def	wmemset.def \
 memmem.def	memrchr.def	rawmemchr.def	strchrnul.def
 
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+CLEANFILES = $(CHEWOUT_FILES) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -1223,12 +1225,22 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
+doc-texinfo: $(CHEWOUT_FILES)
 	cat $(srcdir)/strings.tex >> $(TARGETDOC)
 	cat $(srcdir)/wcstrings.tex >> $(TARGETDOC)
 
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/strings.tex >../strings.xml
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/wcstrings.tex >../wcstrings.xml
+
+doc: doc-docbook doc-texinfo
+
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
diff --git a/newlib/libc/time/Makefile.in b/newlib/libc/time/Makefile.in
index 48ba064..77c194a 100644
--- a/newlib/libc/time/Makefile.in
+++ b/newlib/libc/time/Makefile.in
@@ -311,14 +311,18 @@ CHEWOUT_FILES = \
 	tzset.def	\
 	wcsftime.def
 
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = time.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(CHEWOUT_FILES) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(CHEWOUT_FILES:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(CHEWOUT_FILES) *.ref  $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -706,10 +710,19 @@ $(lpfx)wcsftime.$(oext): strftime.c
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(CHEWOUT_FILES)
-	cat $(srcdir)/time.tex >> $(TARGETDOC)
+doc-texinfo: $(CHEWOUT_FILES)
+	cat $(srcdir)/$(CHAPTER) >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
+
+doc: doc-docbook doc-texinfo
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
diff --git a/newlib/libm/Makefile.in b/newlib/libm/Makefile.in
index 86c4a8e..10687d3 100644
--- a/newlib/libm/Makefile.in
+++ b/newlib/libm/Makefile.in
@@ -309,7 +309,7 @@ libm_la_LDFLAGS = -Xcompiler -nostdlib
 @USE_LIBTOOL_FALSE@noinst_LIBRARIES = libm.a
 info_TEXINFOS = libm.texinfo
 libm_TEXINFOS = targetdep.tex
-CLEANFILES = tmp.texi targetdep.tex stmp-targetdep
+CLEANFILES = tmp.texi targetdep.tex stmp-targetdep *.3 *.xml
 ACLOCAL_AMFLAGS = -I .. -I ../..
 CONFIG_STATUS_DEPENDENCIES = $(newlib_basedir)/configure.host
 all: all-recursive
@@ -731,7 +731,7 @@ info: info-recursive
 
 info-am: $(INFO_DEPS)
 
-install-data-am:
+install-data-am: install-data-local
 
 install-dvi: install-dvi-recursive
 
@@ -883,11 +883,11 @@ uninstall-am: uninstall-dvi-am uninstall-html-am uninstall-info-am \
 	distclean distclean-compile distclean-generic \
 	distclean-libtool distclean-tags dvi dvi-am html html-am info \
 	info-am install install-am install-data install-data-am \
-	install-dvi install-dvi-am install-exec install-exec-am \
-	install-html install-html-am install-info install-info-am \
-	install-man install-pdf install-pdf-am install-ps \
-	install-ps-am install-strip installcheck installcheck-am \
-	installdirs installdirs-am maintainer-clean \
+	install-data-local install-dvi install-dvi-am install-exec \
+	install-exec-am install-html install-html-am install-info \
+	install-info-am install-man install-pdf install-pdf-am \
+	install-ps install-ps-am install-strip installcheck \
+	installcheck-am installdirs installdirs-am maintainer-clean \
 	maintainer-clean-aminfo maintainer-clean-generic mostlyclean \
 	mostlyclean-aminfo mostlyclean-compile mostlyclean-generic \
 	mostlyclean-libtool pdf pdf-am ps ps-am tags tags-recursive \
@@ -927,6 +927,20 @@ math/stmp-def: stmp-targetdep ; @true
 
 complex/stmp-def: stmp-targetdep ; @true
 
+docbook: math/stmp-def complex/stmp-def libm.in.xml
+	xsltproc --xinclude --path ${builddir} --nonet ${srcdir}/../refcontainers.xslt ${srcdir}/libm.in.xml >libm.xml
+	-xmllint --xinclude -path ${builddir} --postvalid --noent --nonet --noout libm.xml
+	xmlto --skip-validation --searchpath ${builddir} html-nochunks --stringparam funcsynopsis.style=ansi libm.xml
+	xmlto --skip-validation --searchpath ${builddir} man -m ${srcdir}/../man.xsl libm.xml
+
+doc: docbook
+
+install-data-local:
+	mkdir -p $(DESTDIR)$(htmldir)
+	$(INSTALL_DATA) libm.html $(DESTDIR)$(htmldir)/
+	mkdir -p $(DESTDIR)$(mandir)/man3
+	$(INSTALL_DATA) *.3 $(DESTDIR)$(mandir)/man3/
+
 .PHONY: force
 force:
 
diff --git a/newlib/libm/common/Makefile.in b/newlib/libm/common/Makefile.in
index ae5949a..c7434ef 100644
--- a/newlib/libm/common/Makefile.in
+++ b/newlib/libm/common/Makefile.in
@@ -383,11 +383,13 @@ chobj = s_cbrt.def s_copysign.def s_exp10.def s_expm1.def s_ilogb.def \
 SUFFIXES = .def
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(chobj) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(chobj:.def=.xml)
+CLEANFILES = $(chobj) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .c .lo .o .obj .xml
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -1431,9 +1433,17 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
 
-doc: $(chobj)
+doc-texinfo: $(chobj)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+
+doc: doc-docbook doc-texinfo
 
 # A partial dependency list.
 
diff --git a/newlib/libm/complex/Makefile.in b/newlib/libm/complex/Makefile.in
index cf731e7..4efea08 100644
--- a/newlib/libm/complex/Makefile.in
+++ b/newlib/libm/complex/Makefile.in
@@ -1,9 +1,9 @@
-# Makefile.in generated by automake 1.11.1 from Makefile.am.
+# Makefile.in generated by automake 1.11.6 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008, 2009  Free Software Foundation,
-# Inc.
+# 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 Free Software
+# Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -18,6 +18,23 @@
 
 
 VPATH = @srcdir@
+am__make_dryrun = \
+  { \
+    am__dry=no; \
+    case $$MAKEFLAGS in \
+      *\\[\ \	]*) \
+        echo 'am--echo: ; @echo "AM"  OK' | $(MAKE) -f - 2>/dev/null \
+          | grep '^AM OK$$' >/dev/null || am__dry=yes;; \
+      *) \
+        for am__flg in $$MAKEFLAGS; do \
+          case $$am__flg in \
+            *=*|--*) ;; \
+            *n*) am__dry=yes; break;; \
+          esac; \
+        done;; \
+    esac; \
+    test $$am__dry = yes; \
+  }
 pkgdatadir = $(datadir)/@PACKAGE@
 pkgincludedir = $(includedir)/@PACKAGE@
 pkglibdir = $(libdir)/@PACKAGE@
@@ -79,27 +96,25 @@ am__objects_2 = lib_a-cabsf.$(OBJEXT) lib_a-casinf.$(OBJEXT) \
 	lib_a-cargf.$(OBJEXT) lib_a-catanhf.$(OBJEXT) \
 	lib_a-cexpf.$(OBJEXT) lib_a-cpowf.$(OBJEXT) \
 	lib_a-csinhf.$(OBJEXT)
-am__objects_5 = lib_a-cabsl.$(OBJEXT) lib_a-creall.$(OBJEXT) \
+am__objects_3 = lib_a-cabsl.$(OBJEXT) lib_a-creall.$(OBJEXT) \
 	lib_a-cimagl.$(OBJEXT)
 @USE_LIBTOOL_FALSE@am_lib_a_OBJECTS = $(am__objects_1) \
-@USE_LIBTOOL_FALSE@	$(am__objects_2) \
-@USE_LIBTOOL_FALSE@	$(am__objects_5)
+@USE_LIBTOOL_FALSE@	$(am__objects_2) $(am__objects_3)
 lib_a_OBJECTS = $(am_lib_a_OBJECTS)
 LTLIBRARIES = $(noinst_LTLIBRARIES)
 libcomplex_la_LIBADD =
-am__objects_3 = cabs.lo cacos.lo cacosh.lo carg.lo casin.lo casinh.lo \
+am__objects_4 = cabs.lo cacos.lo cacosh.lo carg.lo casin.lo casinh.lo \
 	catan.lo catanh.lo ccos.lo ccosh.lo cephes_subr.lo cexp.lo \
 	cimag.lo clog.lo conj.lo cpow.lo cproj.lo creal.lo csin.lo \
 	csinh.lo csqrt.lo ctan.lo ctanh.lo
-am__objects_4 = cabsf.lo casinf.lo ccosf.lo cimagf.lo cprojf.lo \
+am__objects_5 = cabsf.lo casinf.lo ccosf.lo cimagf.lo cprojf.lo \
 	csqrtf.lo cacosf.lo casinhf.lo ccoshf.lo clogf.lo crealf.lo \
 	ctanf.lo cacoshf.lo catanf.lo cephes_subrf.lo conjf.lo \
 	csinf.lo ctanhf.lo cargf.lo catanhf.lo cexpf.lo cpowf.lo \
 	csinhf.lo
-am__objects_6 = cabsl.lo creall.lo ciamgl.lo
-@USE_LIBTOOL_TRUE@am_libcomplex_la_OBJECTS = $(am__objects_3) \
-@USE_LIBTOOL_TRUE@	$(am__objects_4) \
-@USE_LIBTOOL_TRUE@	$(am__objects_6)
+am__objects_6 = cabsl.lo creall.lo cimagl.lo
+@USE_LIBTOOL_TRUE@am_libcomplex_la_OBJECTS = $(am__objects_4) \
+@USE_LIBTOOL_TRUE@	$(am__objects_5) $(am__objects_6)
 libcomplex_la_OBJECTS = $(am_libcomplex_la_OBJECTS)
 libcomplex_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
@@ -118,6 +133,11 @@ LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) \
 	--mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(AM_LDFLAGS) \
 	$(LDFLAGS) -o $@
 SOURCES = $(lib_a_SOURCES) $(libcomplex_la_SOURCES)
+am__can_run_installinfo = \
+  case $$AM_UPDATE_INFO_DIR in \
+    n|no|NO) false;; \
+    *) (install-info --version) >/dev/null 2>&1;; \
+  esac
 DATA = $(noinst_DATA)
 ETAGS = etags
 CTAGS = ctags
@@ -169,6 +189,7 @@ MKDIR_P = @MKDIR_P@
 NEWLIB_CFLAGS = @NEWLIB_CFLAGS@
 NM = @NM@
 NMEDIT = @NMEDIT@
+NO_INCLUDE_LIST = @NO_INCLUDE_LIST@
 OBJDUMP = @OBJDUMP@
 OBJEXT = @OBJEXT@
 OTOOL = @OTOOL@
@@ -178,6 +199,7 @@ PACKAGE_BUGREPORT = @PACKAGE_BUGREPORT@
 PACKAGE_NAME = @PACKAGE_NAME@
 PACKAGE_STRING = @PACKAGE_STRING@
 PACKAGE_TARNAME = @PACKAGE_TARNAME@
+PACKAGE_URL = @PACKAGE_URL@
 PACKAGE_VERSION = @PACKAGE_VERSION@
 PATH_SEPARATOR = @PATH_SEPARATOR@
 RANLIB = @RANLIB@
@@ -255,7 +277,6 @@ src = cabs.c cacos.c cacosh.c carg.c casin.c casinh.c \
       csin.c csinh.c csqrt.c ctan.c ctanh.c
 
 lsrc = cabsl.c creall.c cimagl.c
-
 fsrc = cabsf.c casinf.c ccosf.c cimagf.c cprojf.c  \
         csqrtf.c cacosf.c casinhf.c ccoshf.c clogf.c \
         crealf.c ctanf.c cacoshf.c catanf.c   \
@@ -276,14 +297,18 @@ chobj = cabs.def cacos.def cacosh.def carg.def \
         conj.def cpow.def cproj.def creal.def \
         csin.def csinh.def csqrt.def ctan.def ctanh.def
 
-SUFFIXES = .def
+SUFFIXES = .def .xml
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = complex.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(chobj) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(chobj:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(chobj) *.ref $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .xml .c .lo .o .obj
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -305,6 +330,7 @@ Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
 	    echo ' cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@ $(am__depfiles_maybe)'; \
 	    cd $(top_builddir) && $(SHELL) ./config.status $(subdir)/$@ $(am__depfiles_maybe);; \
 	esac;
+$(srcdir)/../../Makefile.shared:
 
 $(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
 	cd $(top_builddir) && $(MAKE) $(AM_MAKEFLAGS) am--refresh
@@ -317,7 +343,7 @@ $(am__aclocal_m4_deps):
 
 clean-noinstLIBRARIES:
 	-test -z "$(noinst_LIBRARIES)" || rm -f $(noinst_LIBRARIES)
-lib.a: $(lib_a_OBJECTS) $(lib_a_DEPENDENCIES) 
+lib.a: $(lib_a_OBJECTS) $(lib_a_DEPENDENCIES) $(EXTRA_lib_a_DEPENDENCIES)
 	-rm -f lib.a
 	$(lib_a_AR) lib.a $(lib_a_OBJECTS) $(lib_a_LIBADD)
 	$(RANLIB) lib.a
@@ -330,7 +356,7 @@ clean-noinstLTLIBRARIES:
 	  echo "rm -f \"$${dir}/so_locations\""; \
 	  rm -f "$${dir}/so_locations"; \
 	done
-libcomplex.la: $(libcomplex_la_OBJECTS) $(libcomplex_la_DEPENDENCIES) 
+libcomplex.la: $(libcomplex_la_OBJECTS) $(libcomplex_la_DEPENDENCIES) $(EXTRA_libcomplex_la_DEPENDENCIES)
 	$(libcomplex_la_LINK) $(am_libcomplex_la_rpath) $(libcomplex_la_OBJECTS) $(libcomplex_la_LIBADD) $(LIBS)
 
 mostlyclean-compile:
@@ -642,9 +668,6 @@ lib_a-cimagl.o: cimagl.c
 lib_a-cimagl.obj: cimagl.c
 	$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(lib_a_CFLAGS) $(CFLAGS) -c -o lib_a-cimagl.obj `if test -f 'cimagl.c'; then $(CYGPATH_W) 'cimagl.c'; else $(CYGPATH_W) '$(srcdir)/cimagl.c'; fi`
 
-
-
-
 mostlyclean-libtool:
 	-rm -f *.lo
 
@@ -716,10 +739,15 @@ install-am: all-am
 
 installcheck: installcheck-am
 install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
-	  install_sh_PROGRAM="$(INSTALL_STRIP_PROGRAM)" INSTALL_STRIP_FLAG=-s \
-	  `test -z '$(STRIP)' || \
-	    echo "INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'"` install
+	if test -z '$(STRIP)'; then \
+	  $(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
+	    install_sh_PROGRAM="$(INSTALL_STRIP_PROGRAM)" INSTALL_STRIP_FLAG=-s \
+	      install; \
+	else \
+	  $(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
+	    install_sh_PROGRAM="$(INSTALL_STRIP_PROGRAM)" INSTALL_STRIP_FLAG=-s \
+	    "INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'" install; \
+	fi
 mostlyclean-generic:
 
 clean-generic:
@@ -826,10 +854,19 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
+
+doc-texinfo: $(chobj)
+	cat $(srcdir)/$(CHAPTER) >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
 
-doc: $(chobj)
-	cat $(srcdir)/complex.tex >> $(TARGETDOC)
+doc: doc-docbook doc-texinfo
 
 # A partial dependency list.
 
diff --git a/newlib/libm/math/Makefile.in b/newlib/libm/math/Makefile.in
index 233c7c2..028b578 100644
--- a/newlib/libm/math/Makefile.in
+++ b/newlib/libm/math/Makefile.in
@@ -138,14 +138,13 @@ am__objects_2 = lib_a-kf_rem_pio2.$(OBJEXT) lib_a-kf_cos.$(OBJEXT) \
 	lib_a-sf_signif.$(OBJEXT) lib_a-sf_sin.$(OBJEXT) \
 	lib_a-sf_tan.$(OBJEXT) lib_a-sf_tanh.$(OBJEXT) \
 	lib_a-wf_exp2.$(OBJEXT) lib_a-wf_tgamma.$(OBJEXT)
-am__objects_5 = lib_a-el_hypot.$(OBJEXT)
+am__objects_3 = lib_a-el_hypot.$(OBJEXT)
 @USE_LIBTOOL_FALSE@am_lib_a_OBJECTS = $(am__objects_1) \
-@USE_LIBTOOL_FALSE@	$(am__objects_2) \
-@USE_LIBTOOL_FALSE@	$(am__objects_5)
+@USE_LIBTOOL_FALSE@	$(am__objects_2) $(am__objects_3)
 lib_a_OBJECTS = $(am_lib_a_OBJECTS)
 LTLIBRARIES = $(noinst_LTLIBRARIES)
 libmath_la_LIBADD =
-am__objects_3 = k_standard.lo k_rem_pio2.lo k_cos.lo k_sin.lo k_tan.lo \
+am__objects_4 = k_standard.lo k_rem_pio2.lo k_cos.lo k_sin.lo k_tan.lo \
 	e_acos.lo e_acosh.lo e_asin.lo e_atan2.lo e_atanh.lo e_cosh.lo \
 	e_exp.lo e_fmod.lo er_gamma.lo e_hypot.lo e_j0.lo e_j1.lo \
 	e_jn.lo er_lgamma.lo e_log.lo e_log10.lo e_pow.lo \
@@ -157,7 +156,7 @@ am__objects_3 = k_standard.lo k_rem_pio2.lo k_cos.lo k_sin.lo k_tan.lo \
 	w_sincos.lo w_drem.lo s_asinh.lo s_atan.lo s_ceil.lo s_cos.lo \
 	s_erf.lo s_fabs.lo s_floor.lo s_frexp.lo s_ldexp.lo \
 	s_signif.lo s_sin.lo s_tan.lo s_tanh.lo w_exp2.lo w_tgamma.lo
-am__objects_4 = kf_rem_pio2.lo kf_cos.lo kf_sin.lo kf_tan.lo \
+am__objects_5 = kf_rem_pio2.lo kf_cos.lo kf_sin.lo kf_tan.lo \
 	ef_acos.lo ef_acosh.lo ef_asin.lo ef_atan2.lo ef_atanh.lo \
 	ef_cosh.lo ef_exp.lo ef_fmod.lo erf_gamma.lo ef_hypot.lo \
 	ef_j0.lo ef_j1.lo ef_jn.lo erf_lgamma.lo ef_log.lo ef_log10.lo \
@@ -171,10 +170,9 @@ am__objects_4 = kf_rem_pio2.lo kf_cos.lo kf_sin.lo kf_tan.lo \
 	sf_cos.lo sf_erf.lo sf_fabs.lo sf_floor.lo sf_frexp.lo \
 	sf_ldexp.lo sf_signif.lo sf_sin.lo sf_tan.lo sf_tanh.lo \
 	wf_exp2.lo wf_tgamma.lo
-am__objects_6 = el_hypot.lo 
-@USE_LIBTOOL_TRUE@am_libmath_la_OBJECTS = $(am__objects_3) \
-@USE_LIBTOOL_TRUE@	$(am__objects_4) \
-@USE_LIBTOOL_TRUE@	$(am__objects_6)
+am__objects_6 = el_hypot.lo
+@USE_LIBTOOL_TRUE@am_libmath_la_OBJECTS = $(am__objects_4) \
+@USE_LIBTOOL_TRUE@	$(am__objects_5) $(am__objects_6)
 libmath_la_OBJECTS = $(am_libmath_la_OBJECTS)
 libmath_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
@@ -377,7 +375,6 @@ fsrc = kf_rem_pio2.c \
 	wf_exp2.c wf_tgamma.c
 
 lsrc = el_hypot.c
-
 libmath_la_LDFLAGS = -Xcompiler -nostdlib
 @USE_LIBTOOL_TRUE@noinst_LTLIBRARIES = libmath.la
 @USE_LIBTOOL_TRUE@libmath_la_SOURCES = $(src) $(fsrc) $(lsrc)
@@ -397,12 +394,16 @@ chobj = w_acos.def w_acosh.def w_asin.def s_asinh.def \
 
 SUFFIXES = .def
 CHEW = ../../doc/makedoc -f $(srcdir)/../../doc/doc.str
+CHAPTER = math.tex
 TARGETDOC = ../tmp.texi
-CLEANFILES = $(chobj) *.ref
+DOCBOOK_CHEW = ${srcdir}/../../doc/makedocbook.py
+DOCBOOK_OUT_FILES = $(chobj:.def=.xml)
+DOCBOOK_CHAPTER = ${CHAPTER:.tex=.xml}
+CLEANFILES = $(chobj) *.ref  $(DOCBOOK_OUT_FILES)
 all: all-am
 
 .SUFFIXES:
-.SUFFIXES: .def .c .lo .o .obj
+.SUFFIXES: .def .c .lo .o .obj .xml
 $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am $(srcdir)/../../Makefile.shared $(am__configure_deps)
 	@for dep in $?; do \
 	  case '$(am__configure_deps)' in \
@@ -1458,10 +1459,19 @@ objectlist.awk.in: $(noinst_LTLIBRARIES)
 
 .c.def:
 	$(CHEW) < $< > $*.def 2> $*.ref
-	touch stmp-def
+	@touch stmp-def
+
+doc-texinfo: $(chobj)
+	cat $(srcdir)/$(CHAPTER) >> $(TARGETDOC)
+
+.c.xml:
+	$(DOCBOOK_CHEW) < $< > $*.xml || ( rm $*.xml && false )
+	@touch stmp-xml
+
+doc-docbook: $(DOCBOOK_OUT_FILES)
+	${srcdir}/../../doc/chapter-texi2docbook.py <$(srcdir)/${CHAPTER} >../${DOCBOOK_CHAPTER}
 
-doc: $(chobj)
-	cat $(srcdir)/math.tex >> $(TARGETDOC)
+doc: doc-docbook doc-texinfo
 
 # A partial dependency list.
 
-- 
2.4.5

